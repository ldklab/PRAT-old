187c187
<     #####:  185:static unsigned int psk_client_callback(SSL *ssl, const char *hint,
---
>         -:  185:static unsigned int psk_client_callback(SSL *ssl, const char *hint,
194,195c194,195
<     #####:  192:	mosq = SSL_get_ex_data(ssl, tls_ex_index_mosq);
<     #####:  193:	if(!mosq) return 0;
---
>         -:  192:	mosq = SSL_get_ex_data(ssl, tls_ex_index_mosq);
>         -:  193:	if(!mosq) return 0;
197c197
<     #####:  195:	snprintf(identity, max_identity_len, "%s", mosq->tls_psk_identity);
---
>         -:  195:	snprintf(identity, max_identity_len, "%s", mosq->tls_psk_identity);
199,201c199,201
<     #####:  197:	len = mosquitto__hex2bin(mosq->tls_psk, psk, max_psk_len);
<     #####:  198:	if (len < 0) return 0;
<     #####:  199:	return len;
---
>         -:  197:	len = mosquitto__hex2bin(mosq->tls_psk, psk, max_psk_len);
>         -:  198:	if (len < 0) return 0;
>         -:  199:	return len;
598,599c598,599
<     #####:  596:		}else if(mosq->tls_psk){
<     #####:  597:			SSL_CTX_set_psk_client_callback(mosq->ssl_ctx, psk_client_callback);
---
>         -:  596:		}else if(mosq->tls_psk){
>         -:  597:			SSL_CTX_set_psk_client_callback(mosq->ssl_ctx, psk_client_callback);
