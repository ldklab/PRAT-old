2c2
<         -:    0:Programs:101
---
>         -:    0:Programs:82
646c646
<        10:  644:static void set_message_sender_state(MESSAGE_SENDER_INSTANCE* message_sender, MESSAGE_SENDER_STATE new_state)
---
>         8:  644:static void set_message_sender_state(MESSAGE_SENDER_INSTANCE* message_sender, MESSAGE_SENDER_STATE new_state)
648,650c648,650
<        10:  646:    MESSAGE_SENDER_STATE previous_state = message_sender->message_sender_state;
<        10:  647:    message_sender->message_sender_state = new_state;
<        10:  648:    if (message_sender->on_message_sender_state_changed != NULL)
---
>         8:  646:    MESSAGE_SENDER_STATE previous_state = message_sender->message_sender_state;
>         8:  647:    message_sender->message_sender_state = new_state;
>         8:  648:    if (message_sender->on_message_sender_state_changed != NULL)
654c654
<        10:  652:}
---
>         8:  652:}
656c656
<         8:  654:static void indicate_all_messages_as_error(MESSAGE_SENDER_INSTANCE* message_sender)
---
>         6:  654:static void indicate_all_messages_as_error(MESSAGE_SENDER_INSTANCE* message_sender)
660c660
<        8*:  658:    for (i = 0; i < message_sender->message_count; i++)
---
>        6*:  658:    for (i = 0; i < message_sender->message_count; i++)
675c675
<         8:  673:    if (message_sender->messages != NULL)
---
>         6:  673:    if (message_sender->messages != NULL)
682c682
<         8:  680:}
---
>         6:  680:}
730c730
<         8:  728:MESSAGE_SENDER_HANDLE messagesender_create(LINK_HANDLE link, ON_MESSAGE_SENDER_STATE_CHANGED on_message_sender_state_changed, void* context)
---
>         6:  728:MESSAGE_SENDER_HANDLE messagesender_create(LINK_HANDLE link, ON_MESSAGE_SENDER_STATE_CHANGED on_message_sender_state_changed, void* context)
732,733c732,733
<         8:  730:    MESSAGE_SENDER_INSTANCE* message_sender = (MESSAGE_SENDER_INSTANCE*)malloc(sizeof(MESSAGE_SENDER_INSTANCE));
<         8:  731:    if (message_sender == NULL)
---
>         6:  730:    MESSAGE_SENDER_INSTANCE* message_sender = (MESSAGE_SENDER_INSTANCE*)malloc(sizeof(MESSAGE_SENDER_INSTANCE));
>         6:  731:    if (message_sender == NULL)
739,745c739,745
<         8:  737:        message_sender->messages = NULL;
<         8:  738:        message_sender->message_count = 0;
<         8:  739:        message_sender->link = link;
<         8:  740:        message_sender->on_message_sender_state_changed = on_message_sender_state_changed;
<         8:  741:        message_sender->on_message_sender_state_changed_context = context;
<         8:  742:        message_sender->message_sender_state = MESSAGE_SENDER_STATE_IDLE;
<         8:  743:        message_sender->is_trace_on = 0;
---
>         6:  737:        message_sender->messages = NULL;
>         6:  738:        message_sender->message_count = 0;
>         6:  739:        message_sender->link = link;
>         6:  740:        message_sender->on_message_sender_state_changed = on_message_sender_state_changed;
>         6:  741:        message_sender->on_message_sender_state_changed_context = context;
>         6:  742:        message_sender->message_sender_state = MESSAGE_SENDER_STATE_IDLE;
>         6:  743:        message_sender->is_trace_on = 0;
748c748
<         8:  746:    return message_sender;
---
>         6:  746:    return message_sender;
751c751
<         8:  749:void messagesender_destroy(MESSAGE_SENDER_HANDLE message_sender)
---
>         6:  749:void messagesender_destroy(MESSAGE_SENDER_HANDLE message_sender)
753c753
<         8:  751:    if (message_sender == NULL)
---
>         6:  751:    if (message_sender == NULL)
759c759
<         8:  757:        (void)messagesender_close(message_sender);
---
>         6:  757:        (void)messagesender_close(message_sender);
761c761
<         8:  759:        free(message_sender);
---
>         6:  759:        free(message_sender);
763c763
<         8:  761:}
---
>         6:  761:}
765c765
<         5:  763:int messagesender_open(MESSAGE_SENDER_HANDLE message_sender)
---
>         4:  763:int messagesender_open(MESSAGE_SENDER_HANDLE message_sender)
769c769
<         5:  767:    if (message_sender == NULL)
---
>         4:  767:    if (message_sender == NULL)
776c776
<         5:  774:        if (message_sender->message_sender_state == MESSAGE_SENDER_STATE_IDLE)
---
>         4:  774:        if (message_sender->message_sender_state == MESSAGE_SENDER_STATE_IDLE)
778,779c778,779
<         5:  776:            set_message_sender_state(message_sender, MESSAGE_SENDER_STATE_OPENING);
<         5:  777:            if (link_attach(message_sender->link, NULL, on_link_state_changed, on_link_flow_on, message_sender) != 0)
---
>         4:  776:            set_message_sender_state(message_sender, MESSAGE_SENDER_STATE_OPENING);
>         4:  777:            if (link_attach(message_sender->link, NULL, on_link_state_changed, on_link_flow_on, message_sender) != 0)
781,783c781,783
<         5:  779:                LogError("attach link failed");
<         5:  780:                result = MU_FAILURE;
<         5:  781:                set_message_sender_state(message_sender, MESSAGE_SENDER_STATE_ERROR);
---
>         4:  779:                LogError("attach link failed");
>         4:  780:                result = MU_FAILURE;
>         4:  781:                set_message_sender_state(message_sender, MESSAGE_SENDER_STATE_ERROR);
796c796
<         5:  794:    return result;
---
>         4:  794:    return result;
799c799
<         8:  797:int messagesender_close(MESSAGE_SENDER_HANDLE message_sender)
---
>         6:  797:int messagesender_close(MESSAGE_SENDER_HANDLE message_sender)
803c803
<         8:  801:    if (message_sender == NULL)
---
>         6:  801:    if (message_sender == NULL)
810c810
<         8:  808:        indicate_all_messages_as_error(message_sender);
---
>         6:  808:        indicate_all_messages_as_error(message_sender);
812,813c812,813
<         8:  810:        if ((message_sender->message_sender_state == MESSAGE_SENDER_STATE_OPENING) ||
<         8:  811:            (message_sender->message_sender_state == MESSAGE_SENDER_STATE_OPEN))
---
>         6:  810:        if ((message_sender->message_sender_state == MESSAGE_SENDER_STATE_OPENING) ||
>         6:  811:            (message_sender->message_sender_state == MESSAGE_SENDER_STATE_OPEN))
829c829
<         8:  827:            result = 0;
---
>         6:  827:            result = 0;
833c833
<         8:  831:    return result;
---
>         6:  831:    return result;
