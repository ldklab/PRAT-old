        -:    0:Source:/home/ryan/TARGETS/azure-uamqp-c/deps/azure-c-shared-utility/src/hmacsha256.c
        -:    0:Programs:80
        -:    1:// Copyright (c) Microsoft. All rights reserved.
        -:    2:// Licensed under the MIT license. See LICENSE file in the project root for full license information.
        -:    3:
        -:    4:#include <stddef.h>
        -:    5:#include "azure_c_shared_utility/hmacsha256.h"
        -:    6:#include "azure_c_shared_utility/hmac.h"
        -:    7:#include "azure_c_shared_utility/buffer_.h"
        -:    8:
        1:    9:HMACSHA256_RESULT HMACSHA256_ComputeHash(const unsigned char* key, size_t keyLen, const unsigned char* payload, size_t payloadLen, BUFFER_HANDLE hash)
        -:   10:{
        -:   11:    HMACSHA256_RESULT result;
        -:   12:
        1:   13:    if (key == NULL ||
        1:   14:        keyLen == 0 ||
        1:   15:        payload == NULL ||
        1:   16:        payloadLen == 0 ||
        -:   17:        hash == NULL)
        -:   18:    {
    #####:   19:        result = HMACSHA256_INVALID_ARG;
        -:   20:    }
        -:   21:    else
        -:   22:    {
        2:   23:        if ((BUFFER_enlarge(hash, 32) != 0) ||
        1:   24:            (hmac(SHA256, payload, (int)payloadLen, key, (int)keyLen, BUFFER_u_char(hash) ) != 0))
        -:   25:        {
    #####:   26:            result = HMACSHA256_ERROR;
        -:   27:        }
        -:   28:        else
        -:   29:        {
        1:   30:            result = HMACSHA256_OK;
        -:   31:        }
        -:   32:    }
        -:   33:
        1:   34:    return result;
        -:   35:}
