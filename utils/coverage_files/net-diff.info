156,158c156,158
<         -:  151:	request_init(&wrap_req, RQ_FILE, new_sock, RQ_DAEMON, "mosquitto", 0);
<         -:  152:	fromhost(&wrap_req);
<         -:  153:	if(!hosts_access(&wrap_req)){
---
>     #####:  151:	request_init(&wrap_req, RQ_FILE, new_sock, RQ_DAEMON, "mosquitto", 0);
>     #####:  152:	fromhost(&wrap_req);
>     #####:  153:	if(!hosts_access(&wrap_req)){
160,162c160,162
<         -:  155:		if(db->config->connection_messages == true){
<         -:  156:			if(!net__socket_get_address(new_sock, address, 1024)){
<         -:  157:				log__printf(NULL, MOSQ_LOG_NOTICE, "Client connection from %s denied access by tcpd.", address);
---
>     #####:  155:		if(db->config->connection_messages == true){
>     #####:  156:			if(!net__socket_get_address(new_sock, address, 1024)){
>     #####:  157:				log__printf(NULL, MOSQ_LOG_NOTICE, "Client connection from %s denied access by tcpd.", address);
165,166c165,166
<         -:  160:		COMPAT_CLOSE(new_sock);
<         -:  161:		return -1;
---
>     #####:  160:		COMPAT_CLOSE(new_sock);
>     #####:  161:		return -1;
